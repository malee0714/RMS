<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="lims.com.dao.RdmsCommonDao">

	<select id="getBplcCode" parameterType="string" resultType="string">
		SELECT INSPCT_INSTT_CODE AS BPLC_CODE FROM SY_INSPCT_INSTT
		WHERE RDMS_SERVER_IP = #{ip}
		AND UPPER_INSPCT_INSTT_CODE IS NULL AND USE_AT = 'Y' AND DELETE_AT = 'N'
	
	</select>
	
	<update id="updRdmsData" parameterType="HashMap">
		<selectKey keyProperty="USER_ID" order="BEFORE" resultType="hashmap">
			SELECT USER_ID
			FROM SY_USER
			WHERE LOGIN_ID = #{LOGIN_ID}
			AND USE_AT = 'Y' AND DELETE_AT = 'N'
		</selectKey>
		BEGIN
			UPDATE IM_REQEST_EXPRIEM A
			SET A.EQPMN_SEQNO = #{EQPMN_SEQNO},
				A.LAST_RESULT_REGISTER_ID = #{USER_ID},
				A.LAST_RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD'),
				A.LAST_QC_RESULT_REGISTER_ID = #{USER_ID},
				A.LAST_QC_RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD')
			WHERE REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO};
		
			UPDATE
			IM_REQEST_EXPRIEM_RESULT AA
			SET
				AA.RESULT_VALUE = #{RESULT_VALUE},
				AA.MARK_VALUE = #{RESULT_VALUE},
				AA.RESULT_REGISTER_ID = #{USER_ID},
				AA.RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD'),
				AA.RDMS_DOC_NO = #{ORIGINAL_BINDER},
				AA.ORGINL_RDMS_DOC_NO = #{ORIGINAL_BINDER},
				AA.UPDT_RDMS_DOC_NO = #{COPY_BINDER},
				AA.ORGINL_UPDT_RDMS_DOC_NO = #{COPY_BINDER},
				AA.JDGMNT_WORD_CODE = #{JDGMNT_WORD_CODE},
				AA.QC_RESULT_VALUE = #{RESULT_VALUE},
				AA.QC_MARK_VALUE = #{RESULT_VALUE},
				AA.QC_RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD'),
				AA.QC_RESULT_REGISTER_ID = #{USER_ID} ,
				AA.RDMS_UUID = #{RDMS_UUID},
				AA.RDMS_REGIST_AT = 'Y',
				AA.REAL_ANALS_DT = SYSDATE,
				AA.REAL_ANALS_AT = 'Y'
			WHERE AA.EXPR_ODR = #{EXPR_ODR}
			AND AA.REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO};
		END;
	</update>

	<select id="getChkRdmsInfo" parameterType="HashMap" resultType="HashMap">
	
		SELECT
			IRE.REQEST_EXPRIEM_SEQNO
			, IRER.EXPR_ODR
			, IRER.CALC_LAW_SEQNO
			, IR.MTRIL_SEQNO
			, IRE.EXPRIEM_SEQNO
		    , #{BPLC_CODE} AS BPLC_CODE
		    , CASE WHEN UPPER(#{RESULT_VALUE}) = 'N.A.' THEN 'N.A.' ELSE TO_CHAR(ROUND(#{RESULT_VALUE},IRE.MARK_CPHR), 'FM999999999990.'||LPAD('0',NVL(IRE.MARK_CPHR,4),'0')) END
			, #{RESULT_VALUE} RESULT_VALUE
			, #{EQPMN_SEQNO} EQPMN_SEQNO
			, #{LOGIN_ID} LOGIN_ID
			, TRIM(#{EXPRIEM_NM}) EXPRIEM_NM
			, FN_GET_CALC_FOM(IRE.JDGMNT_FOM_CODE, 
						REGEXP_REPLACE(IRE.LCL_VALUE, '[^0-9.-]+'),
						REGEXP_REPLACE(IRE.UCL_VALUE, '[^0-9.-]+'),
						IRE.LCL_VALUE_SE_CODE,
						IRE.UCL_VALUE_SE_CODE, 
						IRE.TEXT_STDR, 
						DECODE(INSTR(UPPER(#{RESULT_VALUE}), 'E'),0,#{RESULT_VALUE},TO_CHAR(TO_NUMBER(#{RESULT_VALUE})))) AS JDGMNT_WORD_CODE
			, #{RDMS_UUID} RDMS_UUID						
			, #{ORIGINAL_BINDER} ORIGINAL_BINDER
			, #{COPY_BINDER} COPY_BINDER
		FROM IM_REQEST_EXPRIEM IRE
		JOIN IM_REQEST_EXPRIEM_RESULT IRER ON IRE.REQEST_EXPRIEM_SEQNO = IRER.REQEST_EXPRIEM_SEQNO
		LEFT JOIN IM_REQEST_EXPRIEM_VRIABL IREV ON IRER.REQEST_EXPRIEM_SEQNO = IREV.REQEST_EXPRIEM_SEQNO AND IREV.EXPR_ODR = IRER.EXPR_ODR
		JOIN IM_REQEST IR ON IRE.REQEST_SEQNO = IR.REQEST_SEQNO
		JOIN SY_EXPRIEM SE ON IRE.EXPRIEM_SEQNO = SE.EXPRIEM_SEQNO
		WHERE IRE.LAST_EXPR_ODR = IRER.EXPR_ODR
		AND IRE.REQEST_SEQNO = #{REQEST_SEQNO} AND IRE.DELETE_AT = 'N' AND IRER.DELETE_AT = 'N'
		AND IRE.PROGRS_SITTN_CODE = 'IM03000003'
		<if test="EXPRIEM_NM != null and EXPRIEM_NM != ''">
			AND (TRIM(SE.RDMS_NM) LIKE '%[' || TRIM(#{EXPRIEM_NM}) || ']%' OR TRIM(IREV.VRIABL_NM) = TRIM(#{EXPRIEM_NM}))
		</if> 
		<if test="REQEST_EXPRIEM_SEQNO != null and REQEST_EXPRIEM_SEQNO != ''">
			AND IRE.REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
		</if>
	</select>

	<update id="deleteRdmsDate" parameterType="HashMap">
		DELETE FROM
		IM_REQEST_EXPRIEM_RESULT_RDMS IRERR
		WHERE IRERR.REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
		AND IRERR.EXPR_ODR = (
			SELECT 
				IRE.LAST_EXPR_ODR 
			FROM IM_REQEST_EXPRIEM IRE 
			WHERE IRE.REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
		) 
	</update>

	<insert id="insRdmsDate" parameterType="HashMap">
		<selectKey resultType="string" keyProperty="EXPR_ODR" order="BEFORE">
			SELECT 
				LAST_EXPR_ODR AS EXPR_ODR
			FROM IM_REQEST_EXPRIEM IIRE 
			WHERE IIRE.REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
			AND DELETE_AT = 'N'
		</selectKey>
			INSERT INTO IM_REQEST_EXPRIEM_RESULT_RDMS
			(
				REQEST_EXPRIEM_SEQNO,
				EXPR_ODR,
				NO,
			 	BPLC_CODE,
				TMPLAT_NM,
				RESULT_VALUE,
				QC_TMPLAT_NM,
				QC_RESULT_VALUE,
				RDMS_UUID,
				RDMS_DOC_NO,
				UPDT_RDMS_DOC_NO,
				ORGINL_RDMS_DOC_NO,
				ORGINL_UPDT_RDMS_DOC_NO,
				LAST_CHANGER_ID,
				LAST_CHANGE_DT
			)
			VALUES(
				#{REQEST_EXPRIEM_SEQNO},
				#{EXPR_ODR},
				(
					SELECT
						NVL(MAX(TO_NUMBER(NO)),0)+1
					FROM IM_REQEST_EXPRIEM_RESULT_RDMS
					WHERE 1 = 1
					AND REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
					AND EXPR_ODR = #{EXPR_ODR}
				),
			  	#{BPLC_CODE},
				#{NAME},
				#{VALUE},
				#{NAME},
				#{VALUE},
				#{VALUE_UUID},
				#{ORIGINAL_BINDER},
				#{COPY_BINDER},
				#{ORIGINAL_BINDER},
				#{COPY_BINDER},
				(SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID} AND USE_AT = 'Y' AND DELETE_AT = 'N'),
				TO_CHAR(SYSDATE,'YYYY-MM-DD')
			)
	</insert>
	
	<select id="getCalcLawInfo" resultType="hashmap" parameterType="hashmap">

		SELECT
			A.VRIABL_ID
			, TRIM(A.VRIABL_NM) VRIABL_NM
			, CASE WHEN UPPER(A.VRIABL_VALUE) = 'N.A.' THEN '0' ELSE A.VRIABL_VALUE END AS VRIABL_VALUE
			, B.NOMFRM_CN
			, A.MARK_CPHR
			, B.VRIABL_ID AS MASTER_VRIABL_ID
			, #{ORIGINAL_BINDER} AS RDMS_DOC_NO
			, #{COPY_BINDER} AS UPDT_RDMS_DOC_NO
			, #{ORIGINAL_BINDER} AS ORGINL_RDMS_DOC_NO
			, #{COPY_BINDER} AS ORGINL_UPDT_RDMS_DOC_NO
			, #{BPLC_CODE} AS BPLC_CODE
		FROM IM_REQEST_EXPRIEM_VRIABL A
		JOIN IM_REQEST_EXPRIEM_RESULT B ON A.REQEST_EXPRIEM_SEQNO = B.REQEST_EXPRIEM_SEQNO AND A.EXPR_ODR = B.EXPR_ODR
		WHERE 1=1 AND A.REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
				AND A.EXPR_ODR = #{EXPR_ODR}

	</select>

	<select id="getPrductCalcSeqno" resultType="HashMap" parameterType="HashMap">
	
		SELECT 
		    #{REQEST_EXPRIEM_SEQNO} REQEST_EXPRIEM_SEQNO
		    , #{EXPR_ODR} EXPR_ODR
		    , #{BPLC_CODE} BPLC_CODE
		    , #{EQPMN_SEQNO} EQPMN_SEQNO
		    , SCL.CALC_LAW_SEQNO 
		    , SCL.NOMFRM_CN
		    , SCL.RVSOP_CN
		    , SCL.VRIABL_ID AS MASTER_VRIABL_ID
		    , SCNV.VRIABL_ID
		    , TRIM(SCNV.VRIABL_NM) VRIABL_NM
		    , SCNV.VRIABL_UNIT_NM
		    , SCNV.BASS_VALUE
		    , SCNV.VRIABL_DC
		    , SCNV.MARK_CPHR
		    , SCNV.RDMS_CNTC_AT
		    , SCNV.LAS_CNTC_AT
		    , SCL.RVSOP_CPHR_RANDOM_CREAT_AT
		    , SCL.MARK_CPHR
			, #{LOGIN_ID} LOGIN_ID
		FROM SY_CALC_NOMFRM_VRIABL SCNV
		JOIN SY_CALC_LAW SCL ON SCNV.CALC_LAW_SEQNO = SCL.CALC_LAW_SEQNO
		WHERE SCL.MTRIL_SEQNO = #{MTRIL_SEQNO} AND SCL.EXPRIEM_SEQNO =  #{EXPRIEM_SEQNO}
		AND SCNV.USE_AT = 'Y' AND SCL.USE_AT = 'Y'
		AND SCNV.DELETE_AT = 'N' AND SCL.DELETE_AT = 'N'
	</select>

	<insert id="insRdmsCalData" parameterType="HashMap">
		INSERT INTO IM_REQEST_EXPRIEM_VRIABL
		(
			REQEST_EXPRIEM_SEQNO,
			EXPR_ODR,
		 	BPLC_CODE,
			VRIABL_ID,
			VRIABL_NM,
			VRIABL_UNIT_NM,
			BASS_VALUE,
			VRIABL_DC,
			MARK_CPHR,
			RDMS_CNTC_AT,
			LAS_CNTC_AT,
			VRIABL_VALUE,
			QC_VRIABL_VALUE,
			REAL_ANALS_AT,
			REAL_ANALS_DT,
			RDMS_UUID,
			RDMS_DOC_NO,
			UPDT_RDMS_DOC_NO,
			ORGINL_RDMS_DOC_NO,
			ORGINL_UPDT_RDMS_DOC_NO,
			DATA_CHANGE_AT,
			LAST_CHANGER_ID,
			LAST_CHANGE_DT
		)VALUES(
			#{REQEST_EXPRIEM_SEQNO},
			#{EXPR_ODR},
		    #{BPLC_CODE},
			#{VRIABL_ID},
			TRIM(#{VRIABL_NM}),
			#{VRIABL_UNIT_NM},
			#{BASS_VALUE},
			#{VRIABL_DC},
			#{MARK_CPHR},
			#{RDMS_CNTC_AT},
			#{LAS_CNTC_AT},
			NVL(#{RESULT_VALUE}, #{BASS_VALUE}),
			NVL(#{RESULT_VALUE}, #{BASS_VALUE}),
			'Y',
			SYSDATE,
			#{RDMS_UUID},
			#{ORIGINAL_BINDER},
			#{COPY_BINDER},
			#{ORIGINAL_BINDER},
			#{COPY_BINDER},
			'N',
			'SYSTEM',
			TO_CHAR(SYSDATE,'YYYY-MM-DD')
		)
	</insert>

	<select id="getchkRdmsMasterCalcInfo" resultType="java.util.HashMap">
		SELECT
			B.*
			 , C.REQEST_EXPRIEM_SEQNO
			 , C.LAST_EXPR_ODR EXPR_ODR
			 , E.MTRIL_SEQNO
			 , C.EXPRIEM_SEQNO
			 , #{BPLC_CODE} AS BPLC_CODE
			 , #{RESULT_VALUE} RESULT_VALUE
			 , #{EQPMN_SEQNO} EQPMN_SEQNO
			 , #{LOGIN_ID} LOGIN_ID
			 , TRIM(B.VRIABL_NM) EXPRIEM_NM
			 , FN_GET_CALC_FOM(C.JDGMNT_FOM_CODE,
							   REGEXP_REPLACE(C.LCL_VALUE, '[^0-9.-]+'),
							   REGEXP_REPLACE(C.UCL_VALUE, '[^0-9.-]+'),
							   C.LCL_VALUE_SE_CODE,
							   C.UCL_VALUE_SE_CODE,
							   C.TEXT_STDR,
							   DECODE(INSTR(UPPER(#{RESULT_VALUE}), 'E'),0,#{RESULT_VALUE},TO_CHAR(TO_NUMBER(#{RESULT_VALUE})))) AS JDGMNT_WORD_CODE
			 , #{RDMS_UUID} RDMS_UUID
			 , #{ORIGINAL_BINDER} ORIGINAL_BINDER
			 , #{COPY_BINDER} COPY_BINDER
		FROM SY_CALC_LAW A
				 JOIN SY_CALC_NOMFRM_VRIABL B ON A.CALC_LAW_SEQNO = B.CALC_LAW_SEQNO
				 JOIN SY_EXPRIEM F ON F.EXPRIEM_SEQNO = A.EXPRIEM_SEQNO
				 JOIN IM_REQEST_EXPRIEM C ON C.EXPRIEM_SEQNO = F.EXPRIEM_SEQNO
				 JOIN IM_REQEST E ON E.REQEST_SEQNO = C.REQEST_SEQNO
		WHERE TRIM(B.VRIABL_NM) = TRIM(#{EXPRIEM_NM}) AND E.REQEST_NO = #{REQEST_NO} AND C.PROGRS_SITTN_CODE = 'IM03000003'

	</select>

	<insert id="insEqpmnOprSplore" parameterType="hashmap">
		INSERT INTO IM_EQPMN_OPR_SPLORE(
			EQPMN_OPR_SPLORE_SEQNO
			,EQPMN_SEQNO
			,REQEST_SEQNO
			,BPLC_CODE
			,BRCD
			,EXPRIEM_NM
			,OPR_DTE
			,LAST_CHANGER_ID
			,LAST_CHANGE_DT
		)VALUES(
			SQ_EQPMN_OPR_SPLORE_SEQNO.NEXTVAL
			, #{EQPMN_SEQNO}
			, #{REQEST_SEQNO}
			, #{BPLC_CODE}
			, #{REQEST_NO}
			, TRIM(#{EXPRIEM_NM})
			, TO_CHAR(SYSDATE, 'YYYY-MM-DD')
			, (SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID})
			, SYSDATE
		)
	</insert>
	
	<update id="delBinderChck" parameterType="lims.com.vo.RdmsMVo">
	BEGIN
		UPDATE IM_REQEST_EXPRIEM_RESULT A SET
		RDMS_DOC_NO = '' , RDMS_UUID = '', RDMS_REGIST_AT = 'N'
		WHERE RDMS_DOC_NO = #{binderItemValue};

		UPDATE IM_REQEST_EXPRIEM_RESULT A SET
		UPDT_RDMS_DOC_NO = '' , RDMS_UUID = '', EXCEL_REGIST_AT = 'N'
		WHERE UPDT_RDMS_DOC_NO = #{binderItemValue};
		
		UPDATE IM_REQEST_EXPRIEM_VRIABL A SET
		RDMS_DOC_NO = '' , RDMS_UUID = ''
		WHERE RDMS_DOC_NO = #{binderItemValue};
		
		UPDATE IM_REQEST_EXPRIEM_VRIABL A SET
		UPDT_RDMS_DOC_NO = '' , RDMS_UUID = ''
		WHERE UPDT_RDMS_DOC_NO = #{binderItemValue};
	END;
	</update>

	<update id="updateCalcLawSeqno" parameterType="hashmap">
	BEGIN
		UPDATE IM_REQEST_EXPRIEM
		SET EQPMN_SEQNO = #{EQPMN_SEQNO}, MARK_CPHR = #{MARK_CPHR}
		WHERE REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
	  	AND LAST_EXPR_ODR = #{EXPR_ODR};

		UPDATE IM_REQEST_EXPRIEM_RESULT
		SET 
			CALC_LAW_SEQNO = #{CALC_LAW_SEQNO}
			, NOMFRM_CN = #{NOMFRM_CN}
			, RVSOP_CN = #{RVSOP_CN}
			, VRIABL_ID = #{MASTER_VRIABL_ID}
			, RVSOP_CPHR_RANDOM_CREAT_AT = #{RVSOP_CPHR_RANDOM_CREAT_AT}
		    , MARK_CPHR = #{MARK_CPHR}
			, LAST_CHANGER_ID = (SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID})
			, LAST_CHANGE_DT = SYSDATE
		WHERE REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
		AND EXPR_ODR = #{EXPR_ODR};
	END;
	</update>
	
	<update id="updateResultValue" parameterType="hashmap">
	BEGIN
		UPDATE IM_REQEST_EXPRIEM
		SET EQPMN_SEQNO = #{EQPMN_SEQNO},
			LAST_RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD'),
			LAST_RESULT_REGISTER_ID = (SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID}),
			LAST_QC_RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD'),
			LAST_QC_RESULT_REGISTER_ID = (SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID})
		WHERE REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
		AND LAST_EXPR_ODR = #{EXPR_ODR};

		UPDATE IM_REQEST_EXPRIEM_RESULT
		SET 
			RESULT_VALUE = #{RESULT_VALUE}
			, QC_RESULT_VALUE = #{RESULT_VALUE}
			, RDMS_REGIST_AT = 'Y'
		    , RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD')
		  	, RESULT_REGISTER_ID = (SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID})
		    , QC_RESULT_REGIST_DTE = TO_CHAR(SYSDATE,'YYYY-MM-DD')
		  	, QC_RESULT_REGISTER_ID = (SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID})
			, LAST_CHANGER_ID = (SELECT USER_ID FROM SY_USER WHERE LOGIN_ID = #{LOGIN_ID})
			, LAST_CHANGE_DT = SYSDATE
		WHERE REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
		AND EXPR_ODR = #{EXPR_ODR};
	END;
	</update>
	
	<update id="updateCalcInfo" parameterType="hashmap">
		UPDATE IM_REQEST_EXPRIEM_VRIABL
		SET 
			VRIABL_VALUE = #{RESULT_VALUE}
			, QC_VRIABL_VALUE = #{RESULT_VALUE}
			, RDMS_UUID = #{RDMS_UUID}
			, RDMS_DOC_NO = #{ORIGINAL_BINDER}
			, UPDT_RDMS_DOC_NO = #{COPY_BINDER}
			, ORGINL_RDMS_DOC_NO = #{ORIGINAL_BINDER}
			, ORGINL_UPDT_RDMS_DOC_NO = #{COPY_BINDER}
			, REAL_ANALS_AT = 'Y'
			, REAL_ANALS_DT = SYSDATE
			, BPLC_CODE = #{BPLC_CODE}
		WHERE REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO}
		AND EXPR_ODR = #{EXPR_ODR}
		AND TRIM(VRIABL_NM) = TRIM(#{EXPRIEM_NM})
	</update>
	
    <update id="updtExcelUploadData" parameterType="hashmap">
		<selectKey keyProperty="EXCEL_BINDERITEMVALUE_ID"  order="BEFORE" resultType="hashmap">
			SELECT NVL(A.UPDT_RDMS_DOC_NO, B.UPDT_RDMS_DOC_NO) EXCEL_BINDERITEMVALUE_ID FROM IM_REQEST_EXPRIEM_RESULT A
			LEFT JOIN IM_REQEST_EXPRIEM_VRIABL B ON A.REQEST_EXPRIEM_sEQNO = B.REQEST_EXPRIEM_SEQNO AND A.EXPR_ODR = B.EXPR_ODR
			JOIN IM_REQEST_EXPRIEM C ON A.EXPR_ODR = C.LAST_EXPR_ODR AND A.REQEST_EXPRIEM_sEQNO = C.REQEST_EXPRIEM_SEQNO
			WHERE (A.REQEST_EXPRIEM_SEQNO = #{REQEST_EXPRIEM_SEQNO} OR B.VRIABL_NM = #{EXPRIEM_NM})
			AND A.DELETE_AT = 'N'
		</selectKey>
		BEGIN

			UPDATE IM_REQEST_EXPRIEM_RESULT
			SET UPDT_RDMS_DOC_NO = #{BINDERITEMVALUE_ID}, EXCEL_REGIST_AT = 'Y'
			WHERE UPDT_RDMS_DOC_NO = #{EXCEL_BINDERITEMVALUE_ID};

			UPDATE IM_REQEST_EXPRIEM_VRIABL
			SET UPDT_RDMS_DOC_NO = #{BINDERITEMVALUE_ID}
			WHERE UPDT_RDMS_DOC_NO = #{EXCEL_BINDERITEMVALUE_ID};

		END;
	</update>
</mapper>